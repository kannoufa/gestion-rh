{% extends 'user/slide.html.twig' %}

{% block title %}Messagerie{% endblock %}

{% block body %}
<div class="page-header">
    <h3 class="page-title">
        <span class="page-title-icon bg-gradient-primary text-white mr-2">
            <i class="mdi mdi-email-variant"></i>
        </span> Messagerie
    </h3>
</div>

 <div class="card">
    <div class="card-body">
        <a href="{{ path('send') }}" class="btn-gradient-danger btn-sm btn mb-3">
            <i class="mdi mdi-mail" aria-hidden="true"></i> Nouveau message
        </a>
        <div class="table-responsive">   
            <table class="table">
                <tbody>
                    {% for message in messages %} 
                    <tr class="unread">
                        <td class="inbox-small-cells">                    
                            <a href="{{ path("delet", {id: message.id}) }}">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-excel-fill text-danger" viewbox="0 0 16 16">
                                    <path d="M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM5.884 4.68L8 7.219l2.116-2.54a.5.5 0 1 1 .768.641L8.651 8l2.233 2.68a.5.5 0 0 1-.768.64L8 8.781l-2.116 2.54a.5.5 0 0 1-.768-.641L7.349 8 5.116 5.32a.5.5 0 1 1 .768-.64z"/>
                                </svg>
                            </a>    
                        </td>
                        <td>
                            {{ message.title }} 
                            {% if message.isRead != true %}
                            <div class="badge badge-gradient-danger rounded-pill badge-sm text-light text-uppercase">Nouveau message</div>
                            {% endif %}
                        </td>
                        <td><i class="mdi mdi-paperclip text-info"></i>De : {{ message.sender.personnel.nom }} {{ message.sender.personnel.prenom }}</td>
                        <td>
                            {% if message.title == 'Demande validation : Ordre de mission' %}
                                <a href="{{ path('user_document', {repo: 'OrdreMission', id: message.message, idMsg:message.id}) }}">
                                    Voir la demande
                                </a>
                            {% elseif message.title == 'Demande validation : Absence' %}
                                <a href="{{ path('user_document', {repo: 'Absence', id: message.message, idMsg:message.id}) }}">
                                    Voir la demande
                                </a>
                            {% else %}
                                <a href="{{ path("read", {id: message.id}) }}">Lire le message</a>
                            {% endif %}
                        </td>
                        <td class="text-right"><i class="mdi mdi-timer text-success"></i> {{ message.createdAt|date('d/m/Y Ã  H:i') }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <div class="pagination mt-4">
                {{knp_pagination_render(messages) }}
            </div>
        </div>      
    </div>
</div>
{% endblock %}
